<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="RPTools Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="RPTools Documentation Atom Feed"><title data-rh="true">Blog | RPTools Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.rptools.net/blog"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Blog | RPTools Documentation"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.rptools.net/blog"><link data-rh="true" rel="alternate" href="https://docs.rptools.net/blog" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.rptools.net/blog" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.0e990008.css">
<link rel="preload" href="/assets/js/runtime~main.71815d8a.js" as="script">
<link rel="preload" href="/assets/js/main.ac3098b1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/RPTools_Logo_512.png" alt="RPTools Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/RPTools_Logo_512.png" alt="RPTools Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">RPTools Documentation</b></a><a class="navbar__item navbar__link" href="/docs/intro">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/road-map/maptool">MapTool Road Map</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/rptools/rptools-doc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/add-on-libraries-static-data">MapTool Add-On Libraries and Static Data</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/add-on-libraries">MapTool Add-On Libraries</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/add-on-libraries-old">MapTool Add-On Libraries (Old)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/lib-token-uri">Lib:Tokens URI access</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/player-databases">Player Databases</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/add-on-libraries-static-data">MapTool Add-On Libraries and Static Data</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-11-11T00:00:00.000Z" itemprop="datePublished">November 11, 2021</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/cwisniew" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Craig Wisniewski</span></a></div><small class="avatar__subtitle" itemprop="description">MapTool Architect / Lead Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>This post describes a work in progress so details may change due to feedback. This is also
the reason that the documentation is a bit sparse. Before creating any issues check the bottom of the
post for things still to be implemented. These features required a <em>HUGE</em> amount of behind the scene
changes to how events, lib:tokens, and Assets work, so there will be a large amount of testing
that needs to be done, I am expecting that there are still several bugs that I have not been able
to uncover yet with my testing. Any help testing would be grealy appreciated. </p><p>It should go without sayind please don&#x27;t run your games with this yet.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="retrieving-static-data-from-add-ons">Retrieving static data from Add-Ons<a class="hash-link" href="#retrieving-static-data-from-add-ons" title="Direct link to heading">​</a></h2><p>You can retrieve the static data that is zipped up in an add-on with the
following macro script function.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">data.getStaticData(namespace, path)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If this macro function is run from the add-on then it is able to retrieve
any file that is in the add-on.</p><p>If the macro function run from ouside of the add-on then it is only able to
retrieve files in the public/ directory and only if the Allow URI Access
flag is set.</p><p>If the path does not exist in the add-on (or a macro tries to read a file that
is not in the public/ directory when not run from the add-on) then an empty
string will be returned.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/map-tool">MapTool</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/map-tool-1-11">MapTool 1.11</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/libraries">Libraries</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/add-on-libraries">MapTool Add-On Libraries</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-11-07T00:00:00.000Z" itemprop="datePublished">November 7, 2021</time> · <!-- -->12 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/cwisniew" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Craig Wisniewski</span></a></div><small class="avatar__subtitle" itemprop="description">MapTool Architect / Lead Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>This post describes a work in progress so details may change due to feedback. This is also
the reason that the documentation is a bit sparse. Before creating any issues check the bottom of the
post for things still to be implemented. These features required a <em>HUGE</em> amount of behind the scene
changes to how events, lib:tokens, and Assets work, so there will be a large amount of testing
that needs to be done, I am expecting that there are still several bugs that I have not been able
to uncover yet with my testing. Any help testing would be grealy appreciated. </p><p>It should go without sayind please don&#x27;t run your games with this yet.</p></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>This information supercedes the previous blog post.</p></div></div><h1>Add-On Libraries</h1><p>MapTool 1.11 introduces add-on libraries which are intended to be an easier
to work with replacement for Lib:Tokens while also offering a lot more functionality.
Lib:Tokens will still function the way that they currently do in MapTool 1.11 and future
versions, but will not be getting a lot of the new features that add-on libraries will have,
so it is recommended that framework developers transition to add-on libraries if supporting
MapTool 1.11 and above.</p><p>I have a very sparse and contrived add-on library I have been using for testing available at
<a href="https://github.com/cwisniew/test-maptool-add-on-lib" target="_blank" rel="noopener noreferrer">test-maptool-add-on-lib</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="format-of-add-on-library-files">Format of add-on library files<a class="hash-link" href="#format-of-add-on-library-files" title="Direct link to heading">​</a></h2><p>Add-On libraries can be shared in a .mtlib file. This file is a zip file with a specific
structure and content. You can import these libraries with the File -&gt; Import Add-On Library menu option.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">library.json            &lt;-- Configuration information for the add-on library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mts_properties.json     &lt;-- Properties for macro script functions in library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">events.json             &lt;-- Event definition for functions in the library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library/                &lt;-- Content of the library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library/public          &lt;-- Content of the library acessable via `lib:// URI`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library/mtscript        &lt;-- MTSCript files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library/mtscript/public &lt;-- MTSCript files that can be called via `[macro(): ]` outside of the library.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="format-of-the-configuration-file">format of the configuration file<a class="hash-link" href="#format-of-the-configuration-file" title="Direct link to heading">​</a></h2><p>The library.json configuration file is a json file with the following structure.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test-library&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.0.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;website&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;www.rptools.net&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;gitUrl&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;github.com/RPTools/test-library&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;authors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;RPTools Team&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;license&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;GPL 3.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;namespace&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;net.rptools.maptool.test-library&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;My new test library for stuff&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;shortDescription&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test library&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;allowsUriAccess&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="format-of-the-events-configuration-file">format of the events configuration file<a class="hash-link" href="#format-of-the-events-configuration-file" title="Direct link to heading">​</a></h2><p>This json file contains which files should be run for certain events.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;events&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;onFirstInit&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;mts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;onFirstInit&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;onInit&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;mts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;onInit&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">&quot;legacyEvents&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;onInitiativeChangeRequest&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;mts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;onInitiativeChangeRequest&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;onInitiativeChange&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;mts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;onInitiativeChange&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;onTokenMove&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;mts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;onTokenMove&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;onMultipleTokensMove&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;mts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;onMultipleTokensMove&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Add ons do not respond to the &quot;onCampaignLoad&quot; event, instead they have 2 new events.</p><ul><li>onFirstInit - This is called only once, when the add on is added. Add the same add on a second time
overwriting the existing one it will <em>not</em> be called again unless the data for the add-on is removed first.</li><li>onInit - This is called every time the campaign is loaded (including after the inital onFirstInit event), and
on the client when sent to a client. This functionality is very much similar to onCampaignLoad.</li></ul><p>The other events must be in the &quot;legacyEvents&quot; section, as the name implies these events are now considered to
be legacy events, new events will be added in the future to replace these (these will not be removed though).</p><p>Currently only macro scripts are supported, in the future JavaScript scripts will also be supported. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mtscript-macros">MTScript macros<a class="hash-link" href="#mtscript-macros" title="Direct link to heading">​</a></h2><ul><li>library/public is only exposed via lib:// URI if <code>allowsUriAccess</code> is set (see configuration file)</li><li>MTScript macros must all end with the file extension .mts to be recognised.</li><li>Any
Only MTScript files in <code>content/mtscript/public</code> can be called using <code>[macro():]</code> from outside of the add-on</li></ul><p>The path of the file becomes that macroname for <code>[macro(): ]</code> the namespace of the add-on library
is used for the <code>@</code> portion.  </p><p>Add-On libraries support both public and private macro functions. Public macro functions must
reside in the mtscript/public and can be called from anywhere (chat, other add-ons, lib:tokens, macro buttons).
You can call them using the following syntax
<code>[macro(&quot;mtscript1@lib:net.rptools.maptool.test-library&quot;)]</code> executes MTScript macro in the file
<code>content/mtscript/public/mtscript1.mts</code>.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>The &quot;public/&quot; is ommited from the macro name when calling it.
You can also use subdirectories to organise your macros and would call them like
<!-- -->[macro(&quot;subdir/script@lib:net.rptools.maptool.test-library&quot;)]</p></div></div><p>The <code>@this</code> shorthand can also be used for calling a macro from within the same add-on, similar to how it works
for lib:Tokens. For example
<code>[macro(&quot;mtscript2@this&quot;)]</code></p><p>Macro script files that are not in the &quot;public/&quot; directory can only be called from within the add-on itself or
by events.
Given a library with the namespace <code>net.mylib.addon</code> with the following files.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mtsscript/func1.mts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mtsscript/public/func2.mts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>[macro(&quot;func1@lib:net.mylib.addon&quot;)]</code> can be called from anywhere, but <code>[macro(&quot;func2@lib:net.mylib.addon&quot;)]</code>
can only be called from a macro that is on the <code>net.mylib.addon</code> add-on.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Since the &quot;public/&quot; is not required, if you have to files with the same name excluding the &quot;public/&quot; part, for example
mtscript/public/funct1.mts
mtscript/funct1.mts</p><p>Then only the one in public/ will be able to be executed, you will not be able to call the other macro</p></div></div><p>The above works not just with `<code>[macro():]</code>  but the other places you would expect it to as well such as
defineFunction() for user defined functions and macro links.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mts_propertiesjson-file">mts_properties.json file<a class="hash-link" href="#mts_propertiesjson-file" title="Direct link to heading">​</a></h3><p>The mts_properties.json file contains property information about macro scripts, it is not required and currrently
only allows you to set properties used in macro links.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;properties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;filename&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;public/auto_exec.mts&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;autoExecute&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Auto executable macro link&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;filename&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;public/myUDF.mts&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;My Test UDF in a drop in lib.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Where</p><ul><li>filename is the path of the file for the MacroScript function (excluding mtscript/).</li><li>autoExecute determines if a macro link created for this macro will be auto executable or not.</li><li>description is the description that will appear in the UDF listing, unlike Lib:Token this is just a plain string and not evaluated if it contains <code>[]</code></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="public-directory">public/ directory<a class="hash-link" href="#public-directory" title="Direct link to heading">​</a></h2><p>The contents of this directory are exposed as a lib:// URI  as long as the allowsUriAccess is set to true in the configuration file.
The public directory part of the filename is discared, for example
public/myhttml.html -&gt; lib://net.myaddons.addon1/myhtml.html</p><p>You can add images to this directory and use src=&quot;lib://&quot; in image tags in HTML.
It will eventually work with audio (probably aleady does but I haven&#x27;t tested it yet so not claining it will yet :) )</p><p>These assets will be included correctly in the campaign file when saving, so you do not need to add them to image tables or
image tokens or any other tricks to make sure that they are included.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-mtscript-library-functions">New MTScript Library functions<a class="hash-link" href="#new-mtscript-library-functions" title="Direct link to heading">​</a></h2><ul><li>library.listAddOnLibraries()            Lists the add on libraries</li><li>library.getInfo(namespace)              Gets information about a library (either add on or lib:token)</li><li>library.listTokenLibraries(namespace)   Lists the Lib:tokens in the campaign</li><li>library.getContents(namespace)          Lists the contents of a library (trusted)</li><li>library.removeAddOn(namepsace)          Removes an add-on (trusted) (used for testing only, probably wont make it into release)</li><li>library.removeAllAddOns()               Removes all add-ons (trusted) (used for testing only, probably wont make it into release)</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="add-on-libraries-and-data">Add-On Libraries and Data<a class="hash-link" href="#add-on-libraries-and-data" title="Direct link to heading">​</a></h2><p>As Add Ons do not live on a token there are no token properties for them. Instead there has been a new
area created for storing data that is a lot more flexible -- and will allow data to be stored agisnt other
entities like maps in the future.
The existing lib property functions below have been modified to work with this new data store if called with
an add-on as the target.</p><ul><li>setLibProperty</li><li>getLibProperty</li><li>getLibPropertyNames</li><li>getMatchingLibProperties</li></ul><p>There are some differences to be aware of when using lib property support for add-ons.</p><ul><li>The name is case sensitive, unles tokens where it is not case sensitive.</li><li>The values stored do not need to be be converted to/from strings like they do with lib:tokens so
in many cases for large json values this should result in a speed improvement.</li><li>The default properties list for the campain are not present for Add-Ons as they are not tokens unlike Lib:Tokens</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="macro-functions">Macro functions<a class="hash-link" href="#macro-functions" title="Direct link to heading">​</a></h3><p>There are some macro functions that will be included in the alpha build for testing purposes that
will allow you to clear/get/edit the data store. The data store is not intended to be used like this
from macros so they will not be in the release build -- there will probably be something similar in 1.12
though. </p><ul><li>data.createNamespace(type, namespace) - Creates namespace for data</li><li>data.listNamespaces(type) - Lists the created namespaces for a type</li><li>data.setData(type, namespace, name, value) - Sets a data value in the store</li><li>data.getData(type, namespace, name) - Gets a data value from the store</li><li>data.listData(type, namespace) - Lists the data stored in a namespace</li><li>data.clearData(type, namespace, name) - Clears the data for the given name in the data store</li><li>data.clearNamespace(type, namespace) - Clears all the data from a namespace</li><li>data.clearAllData() - Clears all the data in the data store</li></ul><p>For add-ons the type will be &#x27;addon:&#x27; and the namespace will be the namespace of the add-on.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="converting-libtokens">Converting Lib:tokens<a class="hash-link" href="#converting-libtokens" title="Direct link to heading">​</a></h2><p>The token popup menu includes a way to export your existing library tokens to an add-on.
This is useful for starting the conversion of an existing token library to an add-on but in all but
the simplest lib:tokens you will want edit the extracted data.</p><p><img loading="lazy" alt="Convert and Export Lib:Tokens" src="/assets/images/export-lib-token-411a9818be4bb776c133809df8d1971a.png" width="574" height="1196" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="things-you-will-want-to-change">Things you will want to change<a class="hash-link" href="#things-you-will-want-to-change" title="Direct link to heading">​</a></h3><ul><li>You should probably change the namespace in the library.json file to something that is unlikely to
conflict with other users. Its a good practice to use a reversed hostname + add on name for this.</li><li>All macros (except event based ones) are created in mtscript/public with the pattern macro_{number&gt;.mts,
this is because macro names have many things that might make them invalid -- or worse dangerous -- filenames.
There is a macro_script_map.txt file saved in the top level which contains the names of your macros and the
filename that they were saved in.</li><li>Not all macro buttons on lib:tokens always contain MT Script macros, they are used for CSS etc as well so
you will probably want to rename and move them to the library/public/ directory.</li><li>The onCampaignLoad macro will be saved as onInit </li><li>All properties are saved in the library/properties directory. These are saved with the names prop_{number}.txt
and a mapping file prop_file_map.txt is created to map these. (this may change slightly when data access
is introduced, more the location)</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>After doing the above you should <em>REALLY</em> take the opportunity to source control your Add-On... </p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="things-not-yet-implemented-but-will-be-so-dont-create-issues-for-these-or-i-will-just-close-them">Things not yet implemented but will be (so dont create issues for these or I will just close them)<a class="hash-link" href="#things-not-yet-implemented-but-will-be-so-dont-create-issues-for-these-or-i-will-just-close-them" title="Direct link to heading">​</a></h2><p>The things detailed below will probably only be implemented for add-ons and there will be no equivalent
functionality for lib:tokens.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="will-be-addedaddressed-in-111">Will be added/addressed in 1.11<a class="hash-link" href="#will-be-addedaddressed-in-111" title="Direct link to heading">​</a></h3><ul><li>There is currenlty no way to properly retrieve json or other data files as data, once this is
added its recommended to store large static data here rather than in the data store as then it will
only need to be sent to client once which can cache it</li><li>There is currently no way to remove add-ons</li><li>There is only minimal checking of data when importing add-ons so error reporting is not great.</li><li>More documentation</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="possibly-will-be-addedaddressed-in-111-depends-on-available-time">Possibly will be added/addressed in 1.11 depends on available time<a class="hash-link" href="#possibly-will-be-addedaddressed-in-111-depends-on-available-time" title="Direct link to heading">​</a></h3><ul><li>Many file types like text/markdown etc are allowed in tate he library but the functions to use them dont yet exist</li><li>Way to create user defined functions through property file (so you dont have to call defineFunction in onInit)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="probably-addedaddressed-in-112">Probably added/addressed in 1.12<a class="hash-link" href="#probably-addedaddressed-in-112" title="Direct link to heading">​</a></h3><ul><li>No Management UI yet</li><li>Expanding of JavaScript API which will make this much more useful will be part of another change.</li><li>Displaying readme markdown file</li><li>Displaying more detailed license information </li><li>Start of support for Add-Ons to to be able to replace &quot;standard&quot; functionality, first things wil be<ul><li>Add-On support for stat sheets (on mouseover on tokens)</li><li>Add-On support for map selection UI</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="probably-addedaddressed-in-113">Probably added/addressed in 1.13<a class="hash-link" href="#probably-addedaddressed-in-113" title="Direct link to heading">​</a></h3><ul><li>Ability to check URL for later version and update from that (most likely github to start with)</li><li>Link Maps to required Add-Ons when exporting/importing</li><li>Dcoumentation / Procuedures for creating a GitHub release for your Add-On.</li><li>The data store could be slightly smatter about large text blocks that remain static and attempt to
cache them</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="questions-i-need-feedback-on">Questions I need feedback on<a class="hash-link" href="#questions-i-need-feedback-on" title="Direct link to heading">​</a></h3><ul><li>Add-Ons lack a built in UI, Lib:Tokens have the macro buttons but Add-Ons dont. Better UIs can
now be created for Add-Ons using frame5/dialog5 with the lib:// URL support (we can expand that to added
other things that are needed) but do we also need something similar to what lib:tokens have.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="other-miscellaneous-stuff--insanity">Other miscellaneous stuff / insanity<a class="hash-link" href="#other-miscellaneous-stuff--insanity" title="Direct link to heading">​</a></h2><p>One thing to realise is this change allows serveral things that are not immediately obvious. For example,
experiment with frame5/dialog5 and lib:// URI support and ability to store images, you would be surprised
how close it is to devloping a standard web site. As a proof of concept I have even been able to get
a small React App written in TypeScript running realtively easily by using webpack to bundle it and copy
it into the public directory. (Note the SVG for the beginner React app doesn&#x27;t work correctly but
replacing it with a png works).</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/map-tool">MapTool</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/map-tool-1-11">MapTool 1.11</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/libraries">Libraries</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/add-on-libraries-old">MapTool Add-On Libraries (Old)</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-10-19T00:00:00.000Z" itemprop="datePublished">October 19, 2021</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/cwisniew" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Craig Wisniewski</span></a></div><small class="avatar__subtitle" itemprop="description">MapTool Architect / Lead Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><strong>Note:</strong> This post describes a work in progress so details may change due to feedback. This is also
the reason that the documentation is a bit sparse. Before creating any issues check the bottom of the
post for things still to be implemented. Also the current code doesn&#x27;t do much checking for the format
of the config/property files this will be improved.</p><h1>Add-On Libraries</h1><p>MapTool 1.11 introduces add-on libraries which are intended to be an easier
to work with replacement for Lib:Tokens while also offering a lot more functionality.
Lib:Tokens will still function the way that they currently do in MapTool 1.11 and future
versions, but will not be getting a lot of the new features that add-on libraries will have,
so it is recommended that framework developers transition to add-on libraries if supporting
MapTool 1.11 and above.</p><p>I have a very sparse and contrived add-on library I have been using for testing available at
<a href="https://github.com/cwisniew/test-maptool-add-on-lib" target="_blank" rel="noopener noreferrer">test-maptool-add-on-lib</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="format-of-add-on-library-files">Format of add-on library files<a class="hash-link" href="#format-of-add-on-library-files" title="Direct link to heading">​</a></h2><p>Add-On libraries can be shared in a .mtlib file. This file is a zip file with a specific
structure and content. You can import these libraries with the File -&gt; Import Add-On Library menu option.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">library.json            &lt;-- Configuration information for the add-on library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mts_properties.json     &lt;-- Properties for macro script functions in library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library/                &lt;-- Content of the library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library/public          &lt;-- Content of the library acessable via `lib:// URI`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library/mtscript        &lt;-- MTSCript files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library/mtscript/public &lt;-- MTSCript files that can be called via `[macro(): ]` outside of the library.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>library/public is only exposed via lib:// URI if <code>allowsUriAccess</code> is set (see configuration file)</li><li>MTScript macros must all end with the file extension .mts to be recognised.</li><li>Only MTScript files in <code>content/mtscript/public</code> can be called using <code>[macro():]</code> from outside of the add-on</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="format-of-the-configuration-file">format of the configuration file<a class="hash-link" href="#format-of-the-configuration-file" title="Direct link to heading">​</a></h2><p>The library.json configuration file is a json file with the following structure.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test-library&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.0.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;website&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;www.rptools.net&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;gitUrl&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;github.com/RPTools/test-library&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;authors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;RPTools Team&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;license&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;GPL 3.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;namespace&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;net.rptools.maptool.test-library&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;My new test library for stuff&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;shortDescription&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test library&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;allowsUriAccess&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mtscript-macros">MTScript macros<a class="hash-link" href="#mtscript-macros" title="Direct link to heading">​</a></h2><p>The name of the file becomes that macroname for <code>[macro(): ]</code> the namespace of the add-on library
is used for the <code>@</code> portion.  For example:</p><p>Add-On libraries support both public and private macro functions. Public macro functions must
reside in the mtscript/public and can be called from anywhere (chat, other add-ons, lib:tokens, macro buttons).
You can call them using the following syntax
<code>[macro(&quot;mtscript1@net.rptools.maptool.test-library&quot;)]</code> executes MTScript macro in the file
<code>content/mtscript/public/mtscript1.mts</code>.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>The &quot;public/&quot; is ommited from the macro name when calling it.
You can also use subdirectories to organise your macros and would call them like
<!-- -->[macro(&quot;subdir/script@net.rptools.maptool.test-library&quot;)]</p></div></div><p>The <code>@this</code> shorthand can also be used for calling a macro from within the same add-on, similar to how it works
for lib:Tokens. For example
<code>[macro(&quot;mtscript2@this&quot;)]</code></p><p>Macro script files that are not in the &quot;public/&quot; directory can only be called from within the add-on itself.
Given a library with the namespace <code>net.mylib.addon</code> with the following files.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mtsscript/func1.mts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mtsscript/public/func2.mts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>[macro(&quot;func1@net.mylib.addon&quot;)]</code> can be called from anywhere, but <code>[macro(&quot;func2@net.mylib.addon&quot;)]</code>
can only be called from a macro that is on the <code>net.mylib.addon</code> add-on.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Since the &quot;public/&quot; is not required, if you have to files with the same name excluding the &quot;public/&quot; part, for example
mtscript/public/funct1.mts
mtscript/funct1.mts</p><p>Then only the one in public/ will be able to be executed, you will not be able to call the other macro</p></div></div><p>The above works not just with `<code>[macro():]</code>  but the other places you would expect it to as well such as
defineFunction() for user defined functions and macro links.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mts_propertiesjson-file">mts_properties.json file<a class="hash-link" href="#mts_propertiesjson-file" title="Direct link to heading">​</a></h3><p>The mts_properties.json file contains property information about macro scripts, it is not required and currrently
only allows you to set properties used in macro links.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;properties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;filename&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;public/auto_exec.mts&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;autoExecute&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Auto executable macro link&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;filename&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;public/myUDF.mts&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;My Test UDF in a drop in lib.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Where</p><ul><li>filename is the path of the file for the MacroScript function (excluding mtscript/).</li><li>autoExecute determines if a macro link created for this macro will be auto executable or not.</li><li>description is the description that will appear in the UDF listing, unlike Lib:Token this is just a plain string and not evaluated if it contains <code>[]</code></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="public-directory">public/ directory<a class="hash-link" href="#public-directory" title="Direct link to heading">​</a></h2><p>The contents of this directory are exposed as a lib:// URI  as long as the allowsUriAccess is set to true in the configuration file.
The public directory part of the filename is discared, for example
public/myhttml.html -&gt; lib://net.myaddons.addon1/myhtml.html</p><p>You an add images to this directory and use src=&quot;lib://&quot; in image tags in HTML.
It will eventually work with audio (probably aleady does but I haven&#x27;t tested it yet so not claining it will yet :) )</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-mtscript-functions">New MTScript functions<a class="hash-link" href="#new-mtscript-functions" title="Direct link to heading">​</a></h2><ul><li>library.listAddOnLibraries()            Lists the add on libraries</li><li>library.getInfo(namespace)              Gets information about a library (either add on or lib:token)</li><li>library.listTokenLibraries(namespace)   Lists the Lib:tokens in the campaign</li><li>library.getContents(namespace)          Lists the contents of a library (trusted)</li><li>library.removeAddOn(namepsace)          Removes an add-on (trusted) (used for testing only, probably wont make it into release)</li><li>library.removeAllAddOns()               Removes all add-ons (trusted) (used for testing only, probably wont make it into release)</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="things-not-yet-implemented-but-will-be-so-dont-create-issues-for-these-or-i-will-just-close-them">Things not yet implemented but will be (so dont create issues for these or I will just close them)<a class="hash-link" href="#things-not-yet-implemented-but-will-be-so-dont-create-issues-for-these-or-i-will-just-close-them" title="Direct link to heading">​</a></h2><ul><li>libProperty acces, including listing, setting, gettting</li><li>No UI yet </li><li>No onCampaignLoad etc events yet.</li><li>There is currenlty no way to access files not in public/ or mtscript/</li><li>Many file types like text/markdown etc are allowed in the library but the functions to use them dont yet exist</li><li>Expanding of JavaScript API which will make this much more useful will be part of another change.</li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/map-tool">MapTool</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/map-tool-1-11">MapTool 1.11</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/libraries">Libraries</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/lib-token-uri">Lib:Tokens URI access</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-10-02T00:00:00.000Z" itemprop="datePublished">October 2, 2021</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/cwisniew" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Craig Wisniewski</span></a></div><small class="avatar__subtitle" itemprop="description">MapTool Architect / Lead Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="issues-with-htmlcssjavascript-prior-to-maptool-110">Issues with HTML/CSS/JavaScript Prior to MapTool 1.10<a class="hash-link" href="#issues-with-htmlcssjavascript-prior-to-maptool-110" title="Direct link to heading">​</a></h2><p>Prior to MapTool 1.10 creating HTML pages is unnecessary cumbersome.
To create HTML dialogs, frames, and overlays you use the following roll options.</p><ul><li><code>[frame(): { } ]</code></li><li><code>[frame5(): { } ]</code></li><li><code>[dialog(): { } ]</code></li><li><code>[dialog5(): { } ]</code></li><li><code>[overlay(): { } ]</code></li></ul><p>The HTML is included in the <code>[ ]</code> which means it has to processed by the MTScript parser. This has both benefits and drawbacks.
The main benefit is that you can use <code>[ ]</code> to execute MTScript elements as a form of templating the HTML, for example</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[frame(&quot;test): {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [r: getName() ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The major drawback is that everything included must be able to pass through the MTScript parser, often this will not be the case especially where CSS or JavaScript are concerned.
You can work around this problem by using macros functions to fetch text from macro, for example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[frame5(&quot;test&quot;): {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [r: getMacroCommand(number(getMacroIndexes(&quot;test/test.html&quot;))) ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="changes-in-maptool-110">Changes in MapTool 1.10<a class="hash-link" href="#changes-in-maptool-110" title="Direct link to heading">​</a></h2><p>In MapTool 1.10 there is a change that allows you to access properties and macros on Lib:Tokens via a URI of the form</p><ul><li>lib://<em>&lt;<!-- -->token name<!-- -->&gt;</em>/macro/<em>&lt;<!-- -->macro name<!-- -->&gt;</em></li><li>lib://<em>&lt;<!-- -->token name<!-- -->&gt;</em>/property/<em>&lt;<!-- -->property name<!-- -->&gt;</em></li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>By default the text fetched using the URI is cached, if you make changes to the content it will not be reflected until you restart MapTool. To work around this you can add the <code>cachelib=false</code> query string as show in examples later on in this post.</p></div></div><p>Where <em>&lt;<!-- -->token name<!-- -->&gt;</em> is the name of the Lib:Token after the Lib: prefix, for example Lib:HTMLTest would be HTMLTest</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="allowing-uri-access">Allowing URI access<a class="hash-link" href="#allowing-uri-access" title="Direct link to heading">​</a></h3><p>There are no special requirements on ownership for the Lib:Token, to allow URI access to Lib:Token properties and macros, anyone will be able to access these values via a URI if the &quot;Allow URI Access&quot; flag needs is set, you can do this via the edit token dialog.
<img loading="lazy" alt="Allow URI access" src="/assets/images/allow-uri-access-1372842f2232a8148e58124a73a4d872.png" width="1370" height="200" class="img_ev3q"></p><p>or the <code>setAllowsURIAccess()</code> macro function.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Reserved names</div><div class="admonitionContent_S0QG"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Some names are reserved for future internal usage and you will not be able set the &quot;Allows URI Access&quot; flags on Lib:Tokens<!-- --> </summary><div><div class="collapsibleContent_i85q"><div>Reserved names are: Lib tokens with the following names (after the lib: part)<ul><li> rptools </li><li> maptool </li><li> maptools (because people often call it maptools) </li><li> internal </li><li> builtin </li><li> standard </li></ul>Lib tokens starting with the following names (after the lib: part)<ul><li> rptools. </li><li> maptool. </li><li> maptools. (because people often call it maptools) </li><li> tokentool. </li><li> net.rptools. </li><li> internal. </li><li> _ </li><li> builtin. </li><li> standard. </li><li> . </li></ul></div></div></div></details></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="macro-functions">Macro functions<a class="hash-link" href="#macro-functions" title="Direct link to heading">​</a></h3><p>Two new MTScript functions have been added that allow you to set or get the &quot;Allows URI access&quot; flag for a token. These can only be run from a trusted macro.</p><ul><li><code>getAllowsURIAccess([&lt;token name&gt;], [&lt;map name&gt;])</code></li><li><code>setAllowsURIAccess(&lt;0|1&gt;, [&lt;token name&gt;, [&lt;map name&gt;])</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="uses-for-lib-uris">Uses for lib:// URIs<a class="hash-link" href="#uses-for-lib-uris" title="Direct link to heading">​</a></h3><p>Lib:// URIs are useful for both CSS and JavaScript inclusion in HTML files, creating frames/dialogs/overlays with HTML, and the <code>js.evalURI()</code> MTScript functions.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="including-javascript-and-css-in-html-using-a-lib-uri">Including JavaScript and CSS in HTML using a lib:// URI<a class="hash-link" href="#including-javascript-and-css-in-html-using-a-lib-uri" title="Direct link to heading">​</a></h4><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">link</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">      </span><span class="token tag attr-name" style="color:#00a4db">rel</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">stylesheet</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">      </span><span class="token tag attr-name" style="color:#00a4db">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">lib://HTMLTest/macro/test/test.css?cachelib=false</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">    </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">This is a test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">test1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">lib://HTMLTest/macro/test/test.js?cachelib=false</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">img</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">asset://87f4e9bfa4f1f3db250b57b3599fa4e9</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will include CSS from the macro called test/test.css and the JavaScript from a macro called test/test.js on the Lib:HTMLTest token.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-framesdialogsoverlays-using-a-lib-uri">Creating frames/dialogs/overlays using a lib:// URI<a class="hash-link" href="#creating-framesdialogsoverlays-using-a-lib-uri" title="Direct link to heading">​</a></h4><p>There are also new MTScript functions that allow you to create frames/dialogs/overlays by passing a lib:// URI which contains the HTML.
These are</p><ul><li><code>html.dialog(&lt;dialog name&gt;, &lt;libURI&gt;, [&lt;options&gt;])</code></li><li><code>html.dialog5(&lt;dialog name&gt;, &lt;libURI&gt;, [&lt;options&gt;])</code></li><li><code>html.frame(&lt;frame name&gt;, &lt;libURI&gt;, [&lt;options&gt;])</code></li><li><code>html.frame5(&lt;frame name&gt;, &lt;libURI&gt;, [&lt;options&gt;])</code></li><li><code>html.overlay(&lt;overlay name&gt;, &lt;libURI&gt;, [&lt;options&gt;])</code></li></ul><p>The optional &quot;options&quot; argument contains the same arguments and format as the frame/dialog/overlay <a href="https://wiki.rptools.info/index.php/frame5_%28roll_option%29" target="_blank" rel="noopener noreferrer">roll options</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="relative-paths">Relative paths<a class="hash-link" href="#relative-paths" title="Direct link to heading">​</a></h3><p>When using the following functions</p><ul><li><code>html.dialog5(&lt;dialog name&gt;, &lt;libURI&gt;, [&lt;options&gt;])</code></li><li><code>html.frame5(&lt;frame name&gt;, &lt;libURI&gt;, [&lt;options&gt;])</code></li><li><code>html.overlay(&lt;overlay name&gt;, &lt;libURI&gt;, [&lt;options&gt;])</code></li></ul><p>The URLs in the HTML file can also be specified using relative paths, for example
Given </p><p><img loading="lazy" alt="Relative paths macros" src="data:image/png;base64,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" width="175" height="247" class="img_ev3q"></p><p>If the HTML is loaded from <code>test/test.html</code> you can use relative paths for the other macros as below</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">link</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">rel</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">stylesheet</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">./test.css?cachelib=false</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">This is a test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">test1</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        </span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">getElementById</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&#x27;test1&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">innerHTML</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:#e3116c">&#x27;...This is a test!&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">./test.js?cachelib=false</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">img</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">asset://87f4e9bfa4f1f3db250b57b3599fa4e9</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">./test2.html</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">test2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">a</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will even work for hyperlink navigation as seen in the link to <code>./test2.htlm</code> aboove</p><p><img loading="lazy" alt="Relative Path Navigation Example" src="/assets/images/relative-path-example-6ac3231c2ab1ad2846cf2994705e9859.gif" width="440" height="448" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="running-javascript-from-a-lib-uri">Running JavaScript from a lib:// URI<a class="hash-link" href="#running-javascript-from-a-lib-uri" title="Direct link to heading">​</a></h4><p>In addition to being able to include JavaScript in HTML via the <code>&lt;script&gt;</code> tag, lib:// URIs can be used to execute JavaScript via the <code>js.evalUI()</code>macro function.</p><ul><li><code>js.evalURI(&lt;namespace&gt;, &lt;libURI&gt;, [arg1, ... argN])</code></li></ul><p>Where</p><ul><li><em>&lt;<!-- -->namespace<!-- -->&gt;</em> is the namespace of the JavaScript context to run the script in.</li><li><em>&lt;<!-- -->libURI<!-- -->&gt;</em> is the lib:// URI to fetch the JavasScript from.</li><li>[arg1, ... argN]<!-- --> is a comma-separated list of arguments to be passed to the script</li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/map-tool">MapTool</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/lib-tokens">lib:tokens</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/map-tool-1-10">MapTool 1.10</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/player-databases">Player Databases</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-09-30T00:00:00.000Z" itemprop="datePublished">September 30, 2021</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/cwisniew" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Craig Wisniewski</span></a></div><small class="avatar__subtitle" itemprop="description">MapTool Architect / Lead Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="authentication-types">Authentication types<a class="hash-link" href="#authentication-types" title="Direct link to heading">​</a></h2><p>Prior to version 1.10 MapTool only supported a single method of authentication which is role based authentication. Each Role (GM and Player) has a password and any client that connects and authenticates with either of these passwords gets that role. There is no restriction player names other than everyone has to have a unique name.</p><p>In MapTool 1.10 there are three authentication methods.</p><ul><li>Role based</li><li>Player specific passwords</li><li>Public Key</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-player-specific-authentication">Using Player Specific Authentication<a class="hash-link" href="#using-player-specific-authentication" title="Direct link to heading">​</a></h2><p>For player specific passwords and public keys authentication a password file must be used as these require that the name of the players are fixed so that they can be matched to the specific password or public key. When starting the server you can specify that a password file is used.
<img loading="lazy" alt="Start Server Dialog" src="/assets/images/start-server-dialog-78032996b316cefe0aafca1c1d71ac9a.png" width="1108" height="476" class="img_ev3q"></p><p>This will load the password file or create a new one if it doesn&#x27;t exist.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="clients-connecting-with-public-keys">Clients Connecting With Public Keys<a class="hash-link" href="#clients-connecting-with-public-keys" title="Direct link to heading">​</a></h2><p>So that the user does not have to type in a password that will not be used they can check &quot;connect using public Key&quot; from the connect to server dialog.</p><p><img loading="lazy" alt="Connect To Sever Dialog" src="/assets/images/connect-using-public-key-b59ffeef6a8ca2ad659c8395124c5dbc.png" width="402" height="432" class="img_ev3q"></p><p>They do not have to check this box as if the server requests the client attempts to authenticates via public key the client will do so even if the user has specified a password. If this value is checked the only way the client can authenticate is via public key so any password in the password text field will be ignored. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-editing-or-removing-players">Adding, Editing, or Removing Players<a class="hash-link" href="#adding-editing-or-removing-players" title="Direct link to heading">​</a></h2><p>The menu option to edit player passwords is under the file menu.
<img loading="lazy" alt="Player Database Menu Option" src="/assets/images/player-database-menu-cbb11af1a235d97bb7b6a13b11433d73.png" width="476" height="368" class="img_ev3q"></p><p>This opens the player database dialog which can be used to add, edit, and remove players. This dialog shows the following information</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="player-database">Player Database<a class="hash-link" href="#player-database" title="Direct link to heading">​</a></h3><p><img loading="lazy" alt="Edit Player Dialog" src="/assets/images/player-database-dc7ec83e44e77470d4983be283cfbb4f.png" width="1208" height="852" class="img_ev3q"></p><ul><li>Player name</li><li>Role, Player or GM</li><li>Authentication Type, Password or Public Key</li><li>Is the player Blocked
Blocked players will not be able to log in. When they try to connect they will get a message with a reason that they are blocked.</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>New, Added, or Modifications to players take effect immediately but the changes will not be written to the password file until this dialog is closed (either with Ok button or dialog close button). This is so that the file will not be continually overwritten many times when making several changes at once.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-or-editing-player">Adding or Editing Player<a class="hash-link" href="#adding-or-editing-player" title="Direct link to heading">​</a></h3><p>Clicking on the Edit or Add button will open a dialog where you can provide the player details.
<img loading="lazy" alt="Edit Player Dialog" src="/assets/images/edit-player-dialog-25e9fde0e61e5fc7db40fa0b74e50e44.png" width="1118" height="934" class="img_ev3q">
This dialog is used to provide the information required for the player database entry.</p><ul><li>Player Name (only editable for Add)</li><li>Role, Player or GM</li><li>If the player has been blocked from logging in, and if so the reason why</li><li>Authentication Type, password or public key</li><li>Player Password (only if authentication type is password)</li><li>Public Key (only if authentication type is public key)</li></ul><p>The password is hashed which is a one way operation, so you will not be able to see a players password so if you and the player forget it you will have to change it to a new one.</p><p>Its recommended that if you want to use player specific authentication you use public keys as that way neither you or the player will need to remember the password. You can add more than one public key in the public key text field so you can easily support players who have multiple computers.</p><p>If you still prefer to use a password over a public key it is <strong>strongly</strong> recommended you use the Generate New Password button so that no one is sharing passwords they may be using elsewhere.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Setting a plyer to blocked will not kick the player, it will only stop them from attempting to connect to the server. You will need to kick the player if you also want to remove them immediately. At this time kicking a blocked player will not send them the reason that they are blocked/kicked but will do so in a future version.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="obtaining-the-players-public-key">Obtaining The Players Public Key<a class="hash-link" href="#obtaining-the-players-public-key" title="Direct link to heading">​</a></h2><p>There is a new Authentication tab on the preferences dialog which contains the public key for your client. If you have multiple machines each will have its a different public key, its also possible if you have multiple versions installed with different data directories then these may also have different public keys.</p><p><img loading="lazy" alt="Players Public Key" src="/assets/images/public-key-9d13a62a7a08cc659d63fbad883f455c.png" width="1752" height="614" class="img_ev3q"></p><p>You can regenerate your public key but if you do so then you will not be able to connect to any server that has your old public key so you will need to ensure you let the person running the server know that your public key has been changed. </p><p>Your public key is also stored in the file <code>.maptool-rptools/config/public.key</code> (or equivalent data directory).</p><p><strong>Warning:</strong> Your private key is also stored in this directory, do not share this with anyone as if they have both your public and private key they will be able to log in as you on other servers your public key is registered with.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="password-file">Password File<a class="hash-link" href="#password-file" title="Direct link to heading">​</a></h2><p>The location of the password file -- assuming the standard data directory -- is <code>.maptool-rptools/config/passwords.json</code> always ensure that you make a backup before editing it as if you make mistakes and you don&#x27;t have a backup you may need to regenerate new passwords for all players. Also never update the password file while the server is running. Public keys for players are stored in the the <code>.maptool-rptools/config/keys</code> directory. If you use multiple computers or share GM duties with someone else you can copy the <code>passwords.json</code> file and <code>keys</code> directory and place them in the same directory on the second computer as they contain nothing specific to the computer it was generated on. You should still endeavour to make sure that this password file is shard with as little number of people as possible. Also <strong>never</strong> use passwords that you have used anywhere else in this file even though they are hashed. If you must use passwords use the button to generate new passwords, but you should prefer public keys!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="format-of-the-password-file">Format of the Password File<a class="hash-link" href="#format-of-the-password-file" title="Direct link to heading">​</a></h3><p>The password file uses json format. </p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;passwords&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;username&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;p1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;password&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/49vX2/i/5YhQZTaalYnoA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;salt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DZAp3sKZSY/vWuLfTG26mhQbOx5PLNT0tRdNvTNMn8KjDlY3jJg180ZBN56ehfkygOk6v0CgySZaufGkOKj7RqOwudzoWZhtNGSabkbI4s85TG7Ecfz8HQQRfIi1XtWrlqkrnuiyD8zQFg9zNr0xvQlUwzL5UOK7emt/xPr2QfU&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Player&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;username&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sp1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;publicKeys&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;pk1.key&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Player&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;username&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;g1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;password&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;9SH7OrqlXyRMrSXy2fQHaw&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;salt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;LOWXSGZ5tNeCwVpzNFuK/4EC+9jHMPmgpZ3Q05kElZyJKSWk0dGQOuZWADH2ZYAs4UvN3DVczMbAO6Dm5+NdnvsZsb/SnZ/xEM0QZ5yvmOh0bGjWEHwqTwFBbRUrzlpzy1nNKdJU8e7G2qWmaLUCDSV5Ut50l9aBfeL29d5btLA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;GM&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;username&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Test4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;password&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ZyZpHxUR18RdhQpFk4n+jA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;salt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SucHGWjcbeDcegZo8A6jekB56iICulF3OtbcomJ+MsShuhKrrls2ZE+T25aTj/xAFu5wZlfE129LgBYvw/C3q2zeEyvjEmXprq5rzW8+c8VaXIRPSHbz5ursX5pRL8qcxbsCm4RFozld6R9/P6+IC3TC3DWoq6CRsvzHpIO2Nnc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Player&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;username&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Test3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;password&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;EyFrs4pM6Euy5zQLHrFoOw&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;salt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Fpvg/PJZGIp7N68OmxMaEGOA1mo4vdg7KoRUDik3Q6P6VovI0YOOdNi3iyo9WgcuukhXjlSoxBqG3Cz/hNQRVVgsXdGwcb86K20imFBbfyzpuNt3a/51u9HTQuYoE8FzzNsTdCI/VPmyQjgvP+AwSYT0i7m/GRXdtugoOWGnDgY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Player&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A player entry that uses a public key will look like the following</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;username&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sp1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;publicKeys&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;pk1.key&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Player&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The value in <code>publicKeys</code> is the name of the file in the <code>keys</code> directory that contains the public keys for the player.</p><p>A player entery that uses a password will look like the following</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;username&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Test3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;password&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;EyFrs4pM6Euy5zQLHrFoOw&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;salt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Fpvg/PJZGIp7N68OmxMaEGOA1mo4vdg7KoRUDik3Q6P6VovI0YOOdNi3iyo9WgcuukhXjlSoxBqG3Cz/hNQRVVgsXdGwcb86K20imFBbfyzpuNt3a/51u9HTQuYoE8FzzNsTdCI/VPmyQjgvP+AwSYT0i7m/GRXdtugoOWGnDgY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Player&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>password</code> field contains the hashed password for the player, the <code>salt</code> field is a randomised value that is used in the function used hash the password.</p><p>If you want to add players you will not be able to -- or be expected to -- generate the hashed password and salt instead you can instead specify the plaintext password and no salt like the following.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;username&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Test3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;password&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;You-Are-Using-A-Random-Password-Arent-You?&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Player&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then the next time the server is started this file will be read and the password will be hashed and the file overwritten to only contain hashed passwords and the salt for the password. This will also generate a <code>passwords.json.backup</code> before overwriting, ensure that you delete this file after testing as it contains then non hashed version of the passwords. But you did remember to use randome passwords and not passwords that you use elsehwere correct?</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/map-tool">MapTool</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/authentication">Authentication</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/map-tool-1-10">MapTool 1.10</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/token-speech-bubbles">Speech and Thought Bubbles</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-09-29T00:00:00.000Z" itemprop="datePublished">September 29, 2021</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/cwisniew" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Craig Wisniewski</span></a></div><small class="avatar__subtitle" itemprop="description">MapTool Architect / Lead Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="callouts">Callouts<a class="hash-link" href="#callouts" title="Direct link to heading">​</a></h2><p>One of the new additions in MapTool 1.10 is the ability to override the name that appears in the speech or thought bubble callouts in MapTool.</p><p>For those that are not already familiar with the functionality MapTool provides the ability to display the following callouts on all clients</p><ul><li><p>Pointer - Spacebar<br>
<img loading="lazy" alt="Pointer" src="/assets/images/pointer-64395066626124b8b05db18c0f82f8a9.png" width="168" height="59" class="img_ev3q"></p></li><li><p>Speech Bubble - Control + Spacebar<br>
<img loading="lazy" alt="Speech Bubble" src="/assets/images/speech-48ddfff68b7f4200ab9769f6526a976d.png" width="112" height="72" class="img_ev3q"></p></li><li><p>Thought Bubble - Shift + Spacebar<br>
<img loading="lazy" alt="Thought Bubble" src="/assets/images/thought-0d9bf2a8bc05edce9088619490e6f1ef.png" width="107" height="63" class="img_ev3q"></p></li><li><p>Pointing Finger - Control + Shift +  Spacebar<br>
<img loading="lazy" alt="Pointing Finger" src="/assets/images/finger-point-d73684839c3a68bcf706b7ccc8ca8841.png" width="166" height="68" class="img_ev3q"></p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setting-the-speechthought-callout-name">Setting the Speech/Thought Callout Name<a class="hash-link" href="#setting-the-speechthought-callout-name" title="Direct link to heading">​</a></h2><p>Previously these callouts always render the name of the player regardless of where the callout is or impersonation status.
In MapTool 1.10 tokens can have a speech name, this can affect the name displayed for both thought and speech bubbles when the mouse pointer is over the token, or the token is impersonated. </p><p>This can be set when dragging a new token on to the map<br>
<img loading="lazy" alt="New Token Dialog" src="/assets/images/new-token-dialog-d6dc582a504d380f39ff0908a24bd923.png" width="436" height="154" class="img_ev3q"></p><p>Or by editing existing tokens.
<img loading="lazy" alt="Edit Token Dialog" src="/assets/images/edit-token-dialog-5c1fb57a4eb4031ab8d3b07bb1f3c519.png" width="629" height="119" class="img_ev3q"></p><p>Or via macro.<br>
<code>setSpeechName(&quot;Speech bubble name&quot;, tokenId)</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="related-macros">Related Macros<a class="hash-link" href="#related-macros" title="Direct link to heading">​</a></h2><p>There are two related macros
<code>getSpeechName()</code> which returns the speech name for the current token. There is also a trusted variant <code>getSpeechName(tokenId)</code> which will return the speech name for the token with the specified id.</p><p><code>setSpeechName(SpeechBubbleName)</code> sets the speech name for the current token. There is also a trusted variant <code>setSpeechName(SpeechBubbleName, tokenId)</code> which will set the speech name for the token with the specified id.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a class="hash-link" href="#examples" title="Direct link to heading">​</a></h2><p>In the following examples the speech and thought bubbles look different to previous versions as another fix in MapTool 1.10 is to size them dynamically so large names wont be rendered outside of the bubbles.</p><p>No impersonated token or token under mouse
<img loading="lazy" alt="No Token" src="/assets/images/anon-7c8db71f45998fd6e77a7917624552fd.png" width="544" height="414" class="img_ev3q"></p><p>Token with Speech Name
<img loading="lazy" alt="Token With Speech Name" src="/assets/images/red-dragon-5eb1a932758235f24d7841b0f99d0e34.png" width="704" height="364" class="img_ev3q"></p><p>Token with really long speech name
<img loading="lazy" alt="Really Long Name" src="/assets/images/captain-spalding-4c3bc4d035322b5d2bf8bebe21ecfab0.png" width="381" height="234" class="img_ev3q"></p><p>Both the eagle and the Dragon have a speech name
<img loading="lazy" alt="Impersonated" src="/assets/images/eagle-5d6014823cc28de03fcb200c568d87f2.png" width="728" height="896" class="img_ev3q"></p><p>Mage and Familiar with Speech Name, mouse over Mage
<img loading="lazy" alt="Mage" src="/assets/images/mage-thought-3fbfa57626b5eb8bfd912ef60e0b2dc5.png" width="433" height="360" class="img_ev3q"></p><p>Mage and Familiar with Speech Name, mouse over Familiar
<img loading="lazy" alt="Mage" src="/assets/images/mage-familiar-thought-9a40f442587f33310cd2ac2eb9bc92a2.png" width="492" height="405" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="determining-which-name-is-displayed">Determining which name is displayed<a class="hash-link" href="#determining-which-name-is-displayed" title="Direct link to heading">​</a></h2><p> In general when deciding which name to use in speech and thought bubbles MapTool will attempt to show the name associated with the following precedence </p><ol><li>Token under the mouse with speech name(if player owns it or is GM)</li><li>Impersonated Token with speech name</li><li>The players name</li></ol><p>Below is a more detailed overview of the logic if you really want to know what it is.</p><div></div><p>If there are multiple tokens under the mouse (e.g. a Token Stack) and at least one has a speech name then the following logic will be used to determine which is used.</p><div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/map-tool">MapTool</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/speech-bubble">speech-bubble</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/map-tool-1-10">MapTool 1.10</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Documentation</a></li><li class="footer__item"><a href="https://wiki.rptools.info" target="_blank" rel="noopener noreferrer" class="footer__link-item">End User Wiki</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/gevEtpC" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.reddit.com/r/MapTool/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reddit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forums.rptools.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forums<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/RPTools" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 RPTools Team. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.71815d8a.js"></script>
<script src="/assets/js/main.ac3098b1.js"></script>
</body>
</html>